id: encounter-create-extract-connectathon
type: FHIRPath
resourceType: Mapping
body:
  "{% assign %}":
    - patientRef: "{{ %QuestionnaireResponse.answers('patient') }}"
    - practitionerRoleRef: "{{ %QuestionnaireResponse.answers('practitioner-role') }}"
    - date: "{{ %QuestionnaireResponse.answers('date') }}"
    - status: "{{ %QuestionnaireResponse.answers('status') }}"
    - class: "{{ %QuestionnaireResponse.answers('class') }}"

  resourceType: Bundle
  type: transaction
  entry:
    - request:
        url: /Encounter
        method: POST
      resource:
        meta:
          profile:
            - "urn://example.com/ph-core/fhir/StructureDefinition/ph-core-encounter"
        resourceType: Encounter
        status: "{{ %status.code }}"
        class: "{{ %class }}"
        subject: "{{ %patientRef }}"
        "{% if %practitionerRoleRef %}":
          participant:
            - individual: "{{ %practitionerRoleRef }}"
        period:
          start: "{{ %date }}"
